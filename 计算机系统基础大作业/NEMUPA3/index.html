<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/avatar.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/avatar.jpg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic%7CRoboto+Condensed:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"aa10n.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.7.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":20},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content="高速缓存及MMU  PA3主要实现高速缓存、分段、分页机制，你想要了解的都在这里。">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机系统基础大作业 NEMU PA3">
<meta property="og:url" content="https://aa10n.github.io/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80%E5%A4%A7%E4%BD%9C%E4%B8%9A/NEMUPA3/index.html">
<meta property="og:site_name" content="aa10n&#39;s blog">
<meta property="og:description" content="高速缓存及MMU  PA3主要实现高速缓存、分段、分页机制，你想要了解的都在这里。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="data:image/png;base64,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">
<meta property="og:image" content="https://i.loli.net/2021/09/28/WxMc1XUerw4VCiO.png">
<meta property="og:image" content="https://i.loli.net/2021/09/28/3fp6vkXAUnScxWs.png">
<meta property="article:published_time" content="2021-09-27T16:41:01.000Z">
<meta property="article:modified_time" content="2021-09-27T18:58:16.875Z">
<meta property="article:author" content="aa10n">
<meta property="article:tag" content="NEMU">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="data:image/png;base64,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">


<link rel="canonical" href="https://aa10n.github.io/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80%E5%A4%A7%E4%BD%9C%E4%B8%9A/NEMUPA3/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://aa10n.github.io/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80%E5%A4%A7%E4%BD%9C%E4%B8%9A/NEMUPA3/","path":"计算机系统基础大作业/NEMUPA3/","title":"计算机系统基础大作业 NEMU PA3"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>计算机系统基础大作业 NEMU PA3 | aa10n's blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KERBMHHC6M"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-KERBMHHC6M","only_pageview":false}</script>
  <script src="/js/third-party/analytics/google-analytics.js"></script>




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">aa10n's blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9"><span class="nav-text">实验内容</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%80%E5%A7%8B%E5%AE%9E%E9%AA%8C"><span class="nav-text">开始实验</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AB%98%E9%80%9F%E7%BC%93%E5%AD%98"><span class="nav-text">高速缓存</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BF%85%E5%81%9A%E4%BB%BB%E5%8A%A1-1%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E7%BA%A7-Cache"><span class="nav-text">必做任务 1：实现一级 Cache</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%89%E5%81%9A%E4%BB%BB%E5%8A%A1-1%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%BA%8C%E7%BA%A7-Cache"><span class="nav-text">选做任务 1：实现二级 Cache</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E6%AE%B5%E6%9C%BA%E5%88%B6"><span class="nav-text">分段机制</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="aa10n"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">aa10n</p>
  <div class="site-description" itemprop="description">一个菜鸡的blog</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">3</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/aa10n" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;aa10n" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:jinde0501@gmail.com" title="E-Mail → mailto:jinde0501@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.instagram.com/jinde_0501/" title="Instagram → https:&#x2F;&#x2F;www.instagram.com&#x2F;jinde_0501&#x2F;" rel="noopener" target="_blank"><i class="fab fa-instagram fa-fw"></i>Instagram</a>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aa10n.github.io/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80%E5%A4%A7%E4%BD%9C%E4%B8%9A/NEMUPA3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="aa10n">
      <meta itemprop="description" content="一个菜鸡的blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="aa10n's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          计算机系统基础大作业 NEMU PA3
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：星期二, 9月 28日 2021年 00:41:01" itemprop="dateCreated datePublished" datetime="2021-09-28T00:41:01+08:00">星期二, 9月 28日 2021年</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80%E5%A4%A7%E4%BD%9C%E4%B8%9A/" itemprop="url" rel="index"><span itemprop="name">计算机系统基础大作业</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <center><font size=6>高速缓存及MMU</font></center>

<p>PA3主要实现高速缓存、分段、分页机制，你想要了解的都在这里。</p>
<span id="more"></span>

<table><tr><td bgcolor=blue><center><b>南京大学的<a href=https://nju-projectn.github.io/ics-pa-gitbook/ics2019/PA2.html target="_blank">实验指导书</a></b></center></td></tr></table>

<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>此次PA是为了理解高速缓存的机制以及从逻辑地址到线性地址（分段）、线性地址到物理地址（分页）之间的关系。</p>
<h2 id="实验内容"><a href="#实验内容" class="headerlink" title="实验内容"></a>实验内容</h2><ul>
<li>阶段 1: 实现 cache（必做）和二级 cache（选做）</li>
<li>阶段 2: 实现 IA-32 分段机制 </li>
<li>阶段 3：实现 IA-32 分页机制</li>
</ul>
<h2 id="开始实验"><a href="#开始实验" class="headerlink" title="开始实验"></a><center><font size=6>开始实验</font></center></h2><hr>
<h2 id="高速缓存"><a href="#高速缓存" class="headerlink" title="高速缓存"></a>高速缓存</h2><p>在计算机系统中，其实内存的速度相对于cpu来说是非常慢的，这时候就需要有一个cache来弥补这种差异上的速度，而内存又可以分成两种，分别为SRAM和DRAM。</p>
<center><b>DRAM和SRAM的电路图</b></center>

<p><img src="data:image/png;base64,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"></p>
<p>DRAM中的一个电容用来存储一个bit，而晶体管则充当一个开关。当电容的电量大于50%，就被认为为1，否则为0。由于电容是会漏电的，所以我们还要不断地为电容充电，让DRAM定时刷新，以确保正确性。而CPU的寄存器采用SRAM，是通过一个触发器来存储1个bit，只要不断电，SRAM中存储的数据就不会丢失。可以看到SRAM相比DRAM的电路来得相对更复杂，所以SRAM的成本远远超过DRAM。</p>
<center><b>存储器金字塔层次结构</b></center>

<p><img src="https://i.loli.net/2021/09/28/WxMc1XUerw4VCiO.png" alt="image.png"></p>
<p>为了解决CPU和存储器之间速度的差距，又由于SRAM的成本远远高于高于DRAM，所以引进了高速缓存的概念。CPU在最上层，速度就是最快的。SRAM在第二层次，其中又可分为L1、L2、L3等高速缓存。第三层对应着主存DRAM，第四层就是我们说的SSD，第五层便是HDD了。这里的金字塔层次结构由上至下的形式也表示了存储器的从小到大。</p>
<p>高速缓存的原理就是利用时间局部性和空间局部性来达到加速的效果。例如当程序访问了一个内存区间，那么这个内存区间很有可能在不久的将来再次被访问，而这个内存区间周围的邻近区间也很有可能会被访问，前后者分别对应着时间局部性和空间局部性。我们把cache向内存进行读写的基本单位称为block。所以只要CPU访问cache的时候命中所需要的内存区间，就不需要浪费很多时间去访存了。但是这也带来了一系列的问题。例如一个内存区域可以分为几个block？由于cache是有限的，当一个block持续地被写cache、出cache时，如何解决这样的冲突？冲突的时候，需要替换哪个block？这就涉及到了替换算法。当写cache的时候需不需要每次都写回内存里？等等一系列问题，所以cache又可以表示成多种形式。</p>
<ul>
<li><p>直接映射（Direct-Mapped Caches）</p>
</li>
<li><p>组相连映射（ Set Associative Caches）</p>
</li>
<li><p>全相连映射（ Fully Associative Caches）</p>
<blockquote>
<p>这些问题太多太多，懒惰写了，具体可参考：<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1495957">多图详解CPU Cache Memory - 云+社区 - 腾讯云 (tencent.com)</a></p>
</blockquote>
</li>
</ul>
<center><b>高速缓存结构</b></center>

<p><img src="https://i.loli.net/2021/09/28/3fp6vkXAUnScxWs.png" alt="image.png"></p>
<p>这个便是高速缓存的结构。高速缓存被组织成S = 2^s 个set，每个set包含E个line。每个line由一个B = 2^b bit的block、一个valid以及一个tag组成。当高速缓存命中的时候，就是tag和valid被校验成功，这时候就可以取出cache中的存储单位（block），这个存储单位通常以1个字节为单位。当高速缓存不命中的时候，这时候CPU才要去内存中取，之后便会根据时间局部性和空间局部性相关的算法以及策略放进cache里。</p>
<hr>
<h2 id="必做任务-1：实现一级-Cache"><a href="#必做任务-1：实现一级-Cache" class="headerlink" title="必做任务 1：实现一级 Cache"></a>必做任务 1：实现一级 Cache</h2><p>需要实现一个64KB的cache，block为64B，八路组相联映射高速缓存，并且其中的替换算法为随机替换算法，写直通策略。</p>
<center><b>nemu/include/memory/cache.h</b></center>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __CACHE_H__</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __CACHE_H__</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;common.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> E 8</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CACHE_BLOCK 64</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CACHE_SIZE 64*1024</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">cache_l1</span> &#123;</span></span><br><span class="line">    <span class="keyword">bool</span> valid;</span><br><span class="line">    <span class="keyword">int</span> tag;</span><br><span class="line">    <span class="keyword">uint8_t</span> byte[CACHE_BLOCK];</span><br><span class="line">&#125; cache[CACHE_SIZE / CACHE_BLOCK];</span><br><span class="line"></span><br><span class="line"><span class="keyword">uint64_t</span> cnt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init_cache</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">uint32_t</span> <span class="title">cache_read</span><span class="params">(<span class="keyword">hwaddr_t</span> addr)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cache_write</span><span class="params">(<span class="keyword">hwaddr_t</span> addr,<span class="keyword">size_t</span> len,<span class="keyword">uint32_t</span> data)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p>定义cache的结构，并且声明了三个函数，分别为初始化cache以及要实现的读写函数。</p>
<center><b>nemu/src/memory/cache.c</b></center>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;common.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;memory/cache.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;burst.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdlib.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">uint32_t</span> <span class="title">dram_read</span><span class="params">(<span class="keyword">hwaddr_t</span> addr, <span class="keyword">size_t</span> len)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">call_ddr3_read</span><span class="params">(<span class="keyword">hwaddr_t</span>, <span class="keyword">void</span> *)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">call_ddr3_write</span><span class="params">(<span class="keyword">hwaddr_t</span>, <span class="keyword">void</span> *, <span class="keyword">uint8_t</span> *)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init_cache</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; CACHE_SIZE / CACHE_BLOCK; i++)&#123;</span><br><span class="line">        cache[i].valid = <span class="literal">false</span>;</span><br><span class="line">        cache[i].tag = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(cache[i].byte, <span class="number">0</span>, CACHE_BLOCK);</span><br><span class="line">    &#125;</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">uint32_t</span> <span class="title">cache_read</span><span class="params">(<span class="keyword">hwaddr_t</span> addr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> <span class="built_in">set</span> = (addr &gt;&gt; <span class="number">6</span>) &amp; <span class="number">0x7f</span>; <span class="comment">//取出地址中set的部分（右移block位并 &amp; 1111111），set = 7 byte (set = 2^s = 128), offset = 6 byte (block = 2^e = 64)</span></span><br><span class="line">    <span class="keyword">bool</span> hit = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="built_in">set</span> * E; i &lt; (<span class="built_in">set</span> + <span class="number">1</span>) * E; i++) &#123; <span class="comment">//找到相应set所在</span></span><br><span class="line">        <span class="keyword">if</span> (cache[i].tag == (addr &gt;&gt; <span class="number">13</span>) &amp;&amp; cache[i].valid) &#123; <span class="comment">//如果tag和地址相符合并且alid == true</span></span><br><span class="line">            hit = <span class="literal">true</span>; </span><br><span class="line">            cnt += <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!hit) &#123; <span class="comment">//找不到</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="built_in">set</span> * E; i &lt; (<span class="built_in">set</span> + <span class="number">1</span>) * E; i++) &#123; <span class="comment">//去到相应set所在</span></span><br><span class="line">            <span class="keyword">if</span> (!cache[i].valid) <span class="comment">//找到空的地方退出</span></span><br><span class="line">            <span class="keyword">break</span>; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (i == (<span class="built_in">set</span> + <span class="number">1</span>) * E) &#123; <span class="comment">// 到最后仍然没有找到空的地方，执行随机替换算法</span></span><br><span class="line">            srand(<span class="number">0</span>);</span><br><span class="line">            i = <span class="built_in">set</span> * E + rand() % E;</span><br><span class="line">        &#125;</span><br><span class="line">        cache[i].valid = <span class="literal">true</span>;</span><br><span class="line">        cache[i].tag = addr &gt;&gt; <span class="number">13</span>;</span><br><span class="line">       <span class="keyword">int</span> j;</span><br><span class="line">       <span class="keyword">uint32_t</span> block = (addr &gt;&gt; <span class="number">6</span>) &lt;&lt; <span class="number">6</span>; <span class="comment">// 取出block</span></span><br><span class="line">         <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; BURST_LEN; j++) &#123;</span><br><span class="line">            call_ddr3_read(block + j * BURST_LEN, cache[i].byte + j * BURST_LEN); </span><br><span class="line">         &#125;</span><br><span class="line">        cnt += <span class="number">200</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cache_write</span><span class="params">(<span class="keyword">hwaddr_t</span> addr, <span class="keyword">size_t</span> len, <span class="keyword">uint32_t</span> data)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> <span class="built_in">set</span> = (addr &gt;&gt; <span class="number">6</span>) &amp; <span class="number">0x7f</span>;</span><br><span class="line">    <span class="keyword">uint32_t</span> offset = addr &amp; (CACHE_BLOCK - <span class="number">1</span>); </span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">bool</span> hit = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="built_in">set</span> * E; i &lt; (<span class="built_in">set</span> + <span class="number">1</span>) * E; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (cache[i].tag == (addr &gt;&gt; <span class="number">13</span>) &amp;&amp; cache[i].valid) &#123;</span><br><span class="line">            hit = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (hit) &#123; <span class="comment">// 写直通</span></span><br><span class="line">        <span class="built_in">memcpy</span>(cache[i].byte + offset, &amp;data, len);</span><br><span class="line">    &#125;     </span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        i = cache_read(addr);</span><br><span class="line">         <span class="built_in">memcpy</span>(cache[i].byte + offset, &amp;data, len);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>理解了cache的原理就很好实现了。这里有一个变量cnt用来观察成功实现了cache后，运行用户程序所需要的时间。</p>
<center><b>nemu/src/memory/dram.c</b></center>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">call_ddr3_read</span><span class="params">(<span class="keyword">hwaddr_t</span> addr, <span class="keyword">void</span> *data)</span></span>&#123;</span><br><span class="line">	ddr3_read(addr,data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">call_ddr3_write</span><span class="params">(<span class="keyword">hwaddr_t</span> addr, <span class="keyword">void</span> *data, <span class="keyword">uint8_t</span> *mask)</span></span>&#123;</span><br><span class="line">	ddr3_write(addr,data,mask);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这两个函数实际上就是调用ddr3里的函数，作为一个接口。</p>
<center><b>nemu/src/monitor/monitor.c</b></center>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">restart</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">	<span class="comment">/* Initialize cache */</span></span><br><span class="line">	init_cache();</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后需要在restart中对cache进行一个初始化操作。</p>
<center><b>nemu/src/monitor/memory/memory.c</b></center>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">uint32_t</span> <span class="title">hwaddr_read</span><span class="params">(<span class="keyword">hwaddr_t</span> addr, <span class="keyword">size_t</span> len)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">uint32_t</span> offset = addr &amp; (CACHE_BLOCK - <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">uint32_t</span> block = cache_read(addr);</span><br><span class="line">	<span class="keyword">uint8_t</span> temp[<span class="number">4</span>];</span><br><span class="line">	<span class="built_in">memset</span>(temp, <span class="number">0</span>, <span class="keyword">sizeof</span>(temp));</span><br><span class="line">	<span class="keyword">if</span> (offset + len &gt;= CACHE_BLOCK) &#123;</span><br><span class="line">		<span class="keyword">uint32_t</span> second_block = cache_read(addr + len);</span><br><span class="line">		<span class="built_in">memcpy</span>(temp, cache[block].byte + offset, CACHE_BLOCK - offset);</span><br><span class="line">		<span class="built_in">memcpy</span>(temp + CACHE_BLOCK - offset, cache[second_block].byte, len - (CACHE_BLOCK - offset));</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="built_in">memcpy</span>(temp, cache[block].byte + offset, len);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> zero = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">uint32_t</span> result = unalign_rw(temp + zero, <span class="number">4</span>) &amp; (~<span class="number">0u</span> &gt;&gt; ((<span class="number">4</span> - len) &lt;&lt; <span class="number">3</span>));</span><br><span class="line">	<span class="comment">//printf(&quot;time: %ld\n&quot;, cnt);</span></span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">hwaddr_write</span><span class="params">(<span class="keyword">hwaddr_t</span> addr, <span class="keyword">size_t</span> len, <span class="keyword">uint32_t</span> data)</span> </span>&#123;</span><br><span class="line">	cache_write(addr, len, data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后要在修改两个函数，就不是直接读写DRAM了，需要先调用cache，当cache缺失的时候才读写DRAM。</p>
<hr>
<h2 id="选做任务-1：实现二级-Cache"><a href="#选做任务-1：实现二级-Cache" class="headerlink" title="选做任务 1：实现二级 Cache"></a>选做任务 1：实现二级 Cache</h2><p>这里其实和实现L1的cache很类似，L2相比L2需要加上一个dirty位。当L1如果不命中，需要到L2里去找，最后当L2缺失的时候，才去DRAM里找。相关代码就不再贴出了。</p>
<hr>
<h2 id="分段机制"><a href="#分段机制" class="headerlink" title="分段机制"></a>分段机制</h2><br>

<p>更新中</p>
<br>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>aa10n
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://aa10n.github.io/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80%E5%A4%A7%E4%BD%9C%E4%B8%9A/NEMUPA3/" title="计算机系统基础大作业 NEMU PA3">https://aa10n.github.io/计算机系统基础大作业/NEMUPA3/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/NEMU/" rel="tag"><i class="fa fa-tag"></i> NEMU</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80%E5%A4%A7%E4%BD%9C%E4%B8%9A/NEMUPA2/" rel="prev" title="计算机系统基础大作业 NEMU PA2">
                  <i class="fa fa-chevron-left"></i> 计算机系统基础大作业 NEMU PA2
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-plug"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">aa10n</span>
</div>


    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  




  <script src="/js/third-party/pace.js"></script>

  





</body>
</html>
